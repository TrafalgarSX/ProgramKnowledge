### 什么是Mac
Mac 有时候也被叫做 tag ，是用来认证一段信息用的。所谓认证，就是要保证两点：
1. 信息的发出者的确是声称的那个人 （比hash多了一个确认发出人身份的功能）
2. 信息没有被篡改过。

可以理解成带密钥的hash

要生成 Mac ，涉及三种算法：

-   一个密钥生成算法，用来生成密钥
-   一个签名算法，根据密钥和信息来生成 Mac
-   一个验证算法，给定密钥和 Mac ，返回“接受”或”拒绝“

经过这三个步骤，就对信息生成了 Mac 。

### Mac 和数字签名
Mac 跟数字签名也有很多区别和联系的。

Mac 跟数字签名也有类似的地方，因为都可以确认发出人身份，同时判断文件有无被篡改。

区别：
1. 生成 Mac 和验证 Mac 需要的密钥是同一个，属于对称加密的范畴。
2. 数字签名属于非对称加密

### HMAC
---
密钥散列消息认证码 keyed-hash message authentication code. 是一种通过特别计算方式之后产生的消息认证码(MAC), 使用密码散列函数，同时结合一个加密密钥。它可以用来保证资料的完整性，同时可以用来作某个消息的身份验证。

HAMC的数学公式是：
$$H M A\,C(K,m)=H\Big((K^{\prime}\oplus o p a d)\mid|\,H\big((K^{\prime}\oplus i p a d)\mid|\,m\big)\Big)$$
其中：
H为密码散列函数（如Md5 SHA家族）
K为密钥
m是要认证的消息
K'是从原始密钥K导出的另一个秘密密钥（如果K短于散列函数的输入块大小，则向右[填充](https://zh.wikipedia.org/wiki/%E5%A1%AB%E5%85%85_(%E5%AF%86%E7%A0%81%E5%AD%A6) "填充 (密码学)")（Padding）零；如果比该块大小更长，则对K进行散列）
|| 代表
⊕ 代表异或（XOR）
opad 是外部填充 （0x5c5c)
ipad 是内部填充  (0x3636)

hmac输出的长度和原始哈希算法的长度一致